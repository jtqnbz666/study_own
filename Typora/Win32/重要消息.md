### æ¶ˆæ¯çš„é™„åŠ ä¿¡æ¯

WPARAM  	4å­—èŠ‚
LPARAM	    4å­—èŠ‚

DWORD åŒå­—  	4å­—èŠ‚
WORD 	å­—		2å­—èŠ‚
	HIWORD(lParam)		LOWORD(lParam)
	HIWORD(wParam)	  LOWORD(wParam)

## 1.é¼ æ ‡æ¶ˆæ¯



## 2.é”®ç›˜æ¶ˆæ¯

â€‹	è™šæ‹Ÿé”®å€¼

## 3.è®¾å¤‡æ”¹å˜æ¶ˆæ¯

.cppæ–‡ä»¶

~~~c++
#pragma warning(disable:4996)
#define WIN32_LEAN_AND_MEAN
#include <stdio.h>
#include <windows.h>
#include "resource.h"
#include <stdlib.h>
#include <Dbt.h>
//æ ‡å‡†è¾“å‡ºè®¾å¤‡å¥æŸ„
HANDLE hConsole;
int n;
HINSTANCE g_hInst;
HCURSOR hCursor1, hCursor2;
//WM_CREATE æ¶ˆæ¯ çš„ å¤„ç†å‡½æ•°
void on_create(HWND hWnd);

//6666 å®šæ—¶å™¨çš„å®šæ—¶å™¨å¤„ç†å‡½æ•°
void timerProc();

//å®šæ—¶å™¨æ¶ˆæ¯å¤„ç†å‡½æ•°
void OnTimer(WPARAM wParam);
char getUmask(DWORD uMask); 

//6 çª—å£çš„æ¶ˆæ¯å¤„ç†å‡½æ•°
LRESULT CALLBACK myWndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);

int WinMain(HINSTANCE hInst,
	HINSTANCE hPrevInst,
	char* cmd,
	int show) {
	g_hInst = hInst;
	//çª—å£ç±»
	WNDCLASSEXA  wc = { 0 };
	wc.cbClsExtra = NULL;
	wc.cbSize = sizeof(wc);
	wc.cbWndExtra = NULL;
	wc.hbrBackground = NULL;
	wc.hCursor = NULL;
	wc.hIcon = NULL;
	wc.hIconSm = NULL;
	wc.hInstance = hInst;
	wc.lpfnWndProc = myWndProc;
	wc.lpszClassName = "å¼ºå“¥çš„çª—å£ç±»";
	wc.lpszMenuName = NULL;
	wc.style = CS_HREDRAW | CS_VREDRAW|CS_DBLCLKS;

	//1 æ³¨å†Œçª—å£ç±»
	RegisterClassEx(&wc);

	//2 åˆ›å»ºçª—å£
	HWND hWnd = CreateWindowEx(wc.style,
		wc.lpszClassName, "ç¬¬ä¸€ä¸ªwindowsçª—å£",
		WS_OVERLAPPEDWINDOW, 100, 100, 500, 500,
		NULL, NULL, hInst, NULL);
	if (!hWnd)
	{
		return FALSE;
	}
	//3 æ˜¾ç¤ºçª—å£
	ShowWindow(hWnd, SW_SHOW);
	//4 åˆ·æ–°
	UpdateWindow(hWnd);

#if  1
	AllocConsole();
	hConsole = GetStdHandle(STD_OUTPUT_HANDLE);
	n = 0;
#endif

	//æ¶ˆæ¯åŒ…
	MSG msg;

	bool ret = true;
	//5 æ¶ˆæ¯å¾ªç¯
	while (ret) {
		//5.1 è·å–æ¶ˆæ¯
		ret = GetMessage(&msg, NULL, 0, 0);
		//5.2 ç¿»è¯‘æ¶ˆæ¯
		TranslateMessage(&msg);
		//5.3 æ´¾å‘æ¶ˆæ¯
		DispatchMessage(&msg);
	}
	MessageBox(NULL, "â—‹( ï¼¾çš¿ï¼¾)ã£Hiahiahiaâ€¦", "ğŸ˜„", MB_OK);
	return 0;
}

//6 çª—å£çš„æ¶ˆæ¯å¤„ç†å‡½æ•°
LRESULT CALLBACK myWndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam) {

	n++;
	DWORD writenLen = 0;
	char buff[256] = { 0 };

	WORD vk;
	WORD daxiaoxie=0;
	switch (msg)
	{
	case WM_DEVICECHANGE:
		if (DBT_DEVICEARRIVAL == wParam) {
			//sprintf(buff, "è®¾å¤‡æ”¹å˜æ¶ˆæ¯\n");
			//WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);

			PDEV_BROADCAST_HDR pDev = (PDEV_BROADCAST_HDR)lParam;
			PDEV_BROADCAST_VOLUME pVol = (PDEV_BROADCAST_VOLUME)pDev;

			//pVol->dbcv_unitmask 
			//wchar_t  buff[20];
			//wsprintf(buff, L"Uç›˜ç›˜ç¬¦æ˜¯ %c ", getUmask(pVol->dbcv_unitmask));
			//MessageBox(NULL, buff, L"uç›˜è¿›æ¥å•¦", NULL);

			//char buff[20];
			sprintf(buff, "xcopy %c:\\ D:\\test /E",
				getUmask(pVol->dbcv_unitmask));
			//	WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);

			system(buff);//æ‰§è¡Œå‘½ä»¤
		}

		break;
	case WM_SYSKEYDOWN:
		daxiaoxie = HIWORD(wParam);

		vk = LOWORD(wParam);
		sprintf(buff, "ç³»ç»Ÿé”®  vk:%d daxiaoxie:%d(%d,%d)\n", vk,daxiaoxie,LOWORD(lParam),HIWORD(lParam));
		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);

		break;
	case WM_SYSKEYUP:
		
		break;
	case WM_KEYDOWN:
		vk = LOWORD(wParam);
		sprintf(buff, "vk:%d daxiaoxie:%d(%d,%d)\n", vk, daxiaoxie, LOWORD(lParam), HIWORD(lParam));

		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);


		break;
	case WM_KEYUP:

		break;
	case WM_MOUSEWHEEL:
		sprintf(buff, "æ»šè½® -- lParam(%d,%d),wParam(%d,%d)\n",
			LOWORD(lParam), HIWORD(lParam)
			, LOWORD(wParam), HIWORD(wParam));
		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);
		break;
	case WM_LBUTTONUP:
		sprintf(buff, "n:%d -- lParam(%d,%d),wParam(%d,%d)\n", n,
			LOWORD(lParam), HIWORD(lParam)
			, LOWORD(wParam), HIWORD(wParam));
		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);
		WriteConsole(hConsole, "å·¦é”®å¼¹èµ·--\n", strlen("å·¦é”®å¼¹èµ·--\n"), &writenLen, NULL);

		break;
	case WM_LBUTTONDOWN:
		sprintf(buff, "n:%d -- lParam(%d,%d),wParam(%d,%d)\n", n,
			LOWORD(lParam), HIWORD(lParam)
			, LOWORD(wParam), HIWORD(wParam));
		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);
		WriteConsole(hConsole, "å·¦é”®æŒ‰ä¸‹----\n", strlen("å·¦é”®æŒ‰ä¸‹----\n"), &writenLen, NULL);
			break;
	case WM_LBUTTONDBLCLK:
		sprintf(buff, "n:%d -- lParam(%d,%d),wParam(%d,%d)\n", n,
			LOWORD(lParam), HIWORD(lParam)
			, LOWORD(wParam), HIWORD(wParam));
		WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);
		WriteConsole(hConsole, "å·¦é”®åŒå‡»====\n", strlen("å·¦é”®åŒå‡»====\n"), &writenLen, NULL);

		break;
	case WM_MOUSEMOVE:
	{
		/*char buff[256] = {0};
	sprintf(buff, "n:%d -- lParam(%d,%d),wParam(%d,%d)\n",n,
		 LOWORD(lParam),HIWORD(lParam)
		,LOWORD(wParam),HIWORD(wParam));
	WriteConsole(hConsole, buff, strlen(buff), &writenLen, NULL);
	*/
		static int flag=1;
		int x = LOWORD(lParam);
		int y = HIWORD(lParam);
		if (x < 250)
		{
			if (2 == flag)
			{
				flag = 1;
				WriteConsole(hConsole, "ä»å³è¾¹åˆ°å·¦è¾¹----\n", strlen("ä»å³è¾¹åˆ°å·¦è¾¹----\n"), &writenLen, NULL);
				SetCursor(hCursor1);
			}
		}
		else
			if (1 == flag)
			{
				flag = 2;
				WriteConsole(hConsole, "ä»å·¦è¾¹åˆ°å³è¾¹=====\n", strlen("ä»å·¦è¾¹åˆ°å³è¾¹=====\n"), &writenLen, NULL);
				SetCursor(hCursor2);
			}
	}break;
	case WM_TIMER:
		//OnTimer(wParam);
		break;
	case WM_COMMAND:

		break;
	case WM_CREATE:	  on_create(hWnd);	break;
	case WM_DESTROY:
		PostQuitMessage(0);
		break;
#if 1
	case WM_CLOSE:
		SetWindowPos(hWnd, HWND_TOPMOST, 50, 50, 300, 300, NULL);
		MessageBox(NULL, "çœŸçš„èµ°å’¯ï¼", "box", MB_YESNO);
		break;
#endif
	default:

		break;
	}
	return DefWindowProc(hWnd, msg, wParam, lParam);
	}

//WM_CREATE æ¶ˆæ¯ çš„ å¤„ç†å‡½æ•°
void on_create(HWND hWnd ) 
{
	//åŠ è½½å…‰æ ‡
	hCursor1 = LoadCursor(g_hInst,MAKEINTRESOURCE(IDC_CURSOR1) );
	hCursor2 = LoadCursor(g_hInst, MAKEINTRESOURCE(IDC_CURSOR2));	
}
char getUmask(DWORD uMask)//è·å–ç›˜ç¬¦
{
	char c;
	for (c = 0; c <= 26; c++) {//26ä¸ªå­—æ¯
		if (uMask & 0x1) {
			break;
		}
		else {
			uMask >>= 1;//å³ç§»ä¸€ä½
		}
	}

	return (c + 'A');
}

~~~

.hæ–‡ä»¶

~~~C++
//{{NO_DEPENDENCIES}}
// Microsoft Visual C++ ç”Ÿæˆçš„åŒ…å«æ–‡ä»¶ã€‚
// ä¾› é‡è¦æ¶ˆæ¯.rc ä½¿ç”¨
//
#define IDC_CURSOR1                     101
#define IDC_CURSOR2                     102

// Next default values for new objects
// 
#ifdef APSTUDIO_INVOKED
#ifndef APSTUDIO_READONLY_SYMBOLS
#define _APS_NEXT_RESOURCE_VALUE        103
#define _APS_NEXT_COMMAND_VALUE         40001
#define _APS_NEXT_CONTROL_VALUE         1001
#define _APS_NEXT_SYMED_VALUE           101
#endif
#endif

~~~

